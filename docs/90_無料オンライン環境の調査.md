# ELKスタック — 無料オンライン環境の調査

ELKスタック（Elasticsearch + Kibana + Logstash）を Docker Compose で動かせる無料のオンラインサービスを調査した。

## 前提条件

ELKスタックを動かすための最低要件:

- **メモリ**: 最低 4GB（Elasticsearch 2GB + Kibana 1GB + Logstash 1GB）
- **Docker Compose**: 対応必須
- **ポート公開**: Kibana（5601）にブラウザからアクセス可能
- **費用**: 無料枠で利用可能

## 調査結果の比較表

| サービス | メモリ | Docker Compose | ポート公開 | 無料枠 | ELK適合 |
|----------|--------|----------------|------------|--------|---------|
| **GitHub Codespaces** | 8GB / 16GB | 対応 | 自動転送 | 月120コア時間 | **最適** |
| **Gitpod** | 8GB | 対応 | 対応 | あり（不透明） | 条件付き可 |
| **Google Cloud Shell** | 1.7GB / 3.75GB | 対応 | Web Preview | 完全無料 | 不可（メモリ不足） |
| **Play with Docker** | 4GB | 対応 | 対応 | 完全無料 | サービス終了間近 |
| **Railway** | 0.5GB | 非対応 | 対応 | 30日トライアル | 不可 |
| **Render** | 512MB | 非対応 | 対応 | 月750時間 | 不可 |
| **Fly.io** | 256MB〜 | 非対応 | 対応 | 廃止済み | 不可 |

## 各サービスの詳細

### 1. GitHub Codespaces（最有力候補）

- **メモリ**: 2コア/8GB RAM（デフォルト）、4コア/16GB RAM（選択可）
- **Docker Compose**: 対応（devcontainer 設定で定義可能）
- **ポート公開**: 自動ポートフォワーディング（5601 を自動検出してブラウザアクセス可能）
- **無料枠**: 月120コア時間 + 15GB ストレージ
  - 2コアマシン: 月60時間利用可能
  - 4コアマシン: 月30時間利用可能

**評価: 実用可能**

ELKスタックを無料で動かせる唯一の現実的な選択肢。4コアマシン（16GB RAM）を選択すれば快適に動作する。2コアマシン（8GB RAM）でも各コンテナのメモリを制限すれば動作可能。

使わないときは Codespace を停止することで、無料枠を節約できる。

### 2. Gitpod（条件付きで可能）

- **メモリ**: Standard: 最大4コア/8GB RAM
- **Docker Compose**: 対応（`network_mode: host` が必要）
- **無料枠**: あり（ただしサービス体制変更中）

**評価: 不安定**

Gitpod Classic は 2025年10月にサービス終了。「Ona」にリブランドされ、サービス体制が大きく変化中。無料枠の詳細が不透明なため、積極的には推奨しにくい。

### 3. Google Cloud Shell（メモリ不足）

- **メモリ**: 通常 1.7GB、Boost モード 3.75GB
- **Docker Compose**: 対応
- **無料枠**: 完全無料（Google アカウントのみ必要）
- **制限**: アイドル20分でタイムアウト、週60時間

**評価: 不可**

通常モード（1.7GB）では Elasticsearch 単体でも起動困難。Boost モード（3.75GB）でも 4GB に達せず、ELK 3コンテナの同時起動は厳しい。

### 4. Play with Docker（サービス終了間近）

- **メモリ**: 最大 4GB/インスタンス
- **Docker Compose**: 対応
- **無料枠**: 完全無料
- **制限**: 4時間でセッション強制終了

**評価: 利用不可**

技術的には 4GB メモリでギリギリ動作可能だが、**2026年3月1日にサービス終了予定**のため、現時点では利用を開始すべきではない。

### 5. Railway / Render / Fly.io（不適合）

いずれも PaaS 型サービスで、以下の理由から ELK スタックには不向き:

- **メモリ不足**: 無料枠は 256MB〜512MB 程度で、Elasticsearch の起動すら不可能
- **Docker Compose 非対応**: 各コンテナを個別サービスとしてデプロイする必要がある
- **無料枠の制限**: トライアル期間のみ、または無料枠が廃止済み

## 結論

### 推奨: GitHub Codespaces

無料のオンラインサービスでは **GitHub Codespaces が唯一の現実的な選択肢**。

| 構成 | メモリ | 月の利用可能時間 | 快適さ |
|------|--------|------------------|--------|
| 4コアマシン | 16GB | 30時間 | 快適 |
| 2コアマシン | 8GB | 60時間 | やや制約あり |

ただし、月30〜60時間の制限があるため、**学習用途にはローカルの Docker Desktop 環境が最も安定で制約がない**。

### 補足: GitHub Codespaces を使う場合の準備

リポジトリに `.devcontainer/devcontainer.json` を追加し、以下のように設定する:

```json
{
  "name": "ELK Stack",
  "dockerComposeFile": "../docker-compose.yml",
  "service": "python-ml",
  "workspaceFolder": "/app",
  "hostRequirements": {
    "cpus": 4,
    "memory": "16gb"
  },
  "forwardPorts": [5601, 9200]
}
```

---

*調査日: 2026-02-23*
